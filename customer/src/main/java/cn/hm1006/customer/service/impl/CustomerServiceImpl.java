package cn.hm1006.customer.service.impl;import cn.hm1006.customer.config.RestTemplateConfig;import cn.hm1006.customer.entity.Customer;import cn.hm1006.customer.mapper.CustomerMapper;import cn.hm1006.customer.service.ICustomerService;import cn.hm1006.customer.utils.JSON;import lombok.extern.slf4j.Slf4j;import org.springframework.http.HttpEntity;import org.springframework.http.HttpHeaders;import org.springframework.http.MediaType;import org.springframework.stereotype.Service;import org.springframework.web.client.RestTemplate;import javax.annotation.Resource;import java.util.Map;/** * @author : Two * @version : v1.0 * @description TODO * @date : 2021/3/2 21:59 */@Service@Slf4jpublic class CustomerServiceImpl implements ICustomerService {    @Resource    private RestTemplateConfig restTemplateConfig;    @Resource    private CustomerMapper customerMapper;    @Override    public String searchAll(Map<String, Object> map) {        if (map.size()>0) {            //将map转为json            String json = JSON.toJson(map);            //设置http请求            HttpHeaders httpHeaders = new HttpHeaders();            httpHeaders.setContentType(MediaType.parseMediaType("application/json;charset=utf8"));            HttpEntity httpEntity = new HttpEntity(json, httpHeaders);            RestTemplate template = restTemplateConfig.getTemplate();            //发送post请求            String postBody = template.postForObject("http://localhost:8080/search/table", httpEntity, String.class);            return postBody;        }        return "";    }    @Override    public void addCustomer(Customer customer) {        //1、添加到数据库        int result = customerMapper.addCustomer(customer);        if (result<1){            log.error("【添加客户信息到数据库失败!】customer={}",customer);            throw new RuntimeException("【添加客户信息到数据库失败!】");        }        //2、添加到es        //将map转为json        String json = JSON.toJson(customer);        //设置http请求        HttpHeaders httpHeaders = new HttpHeaders();        httpHeaders.setContentType(MediaType.parseMediaType("application/json;charset=utf8"));        HttpEntity httpEntity = new HttpEntity(json, httpHeaders);        RestTemplate template = restTemplateConfig.getTemplate();        //发送post请求        String postBody = template.postForObject("http://localhost:8080/search/add", httpEntity, String.class);    }}